<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ME 405 Term Project: State Estimation and Odometry</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ME 405 Term Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('state_estimation_odometry.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">State Estimation and Odometry </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2 class="doxsection"><a class="anchor" id="autotoc_md54"></a>
Motivation</h2>
<p>As part of Lab 0x05, we explored state estimation techniques with the goal of reconstructing the Romi’s motion using a mathematical model combined with sensor measurements. The motivation was to move beyond raw encoder data and instead maintain a consistent estimate of key system states such as wheel velocities, arc length traveled, and heading.</p>
<p>While this approach aligned well with the theoretical objectives of the lab, implementing and validating the estimator on real hardware revealed important limitations. The work ultimately informed our decision to rely on odometry for the term project, but the process of designing, implementing, and testing the estimator provided valuable insight into the behavior of the system.</p>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md56"></a>
State Estimator Implementation</h2>
<p>The state estimator developed in Lab 0x05 was based on a discrete-time observer formulation. A continuous-time state-space model was first constructed and then discretized for implementation on the microcontroller. The estimator state vector included wheel velocities, arc length, and heading, and incorporated encoder and IMU measurements through an observer gain matrix.</p>
<p>The estimator was implemented as its own task within the cooperative multitasking framework. At each update, it propagated the system state forward in time using the discrete model and corrected the estimate using incoming measurements. In principle, this structure was intended to provide smoother and more reliable state information than raw encoder measurements alone.</p>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md58"></a>
Comparison to Encoder Measurements</h2>
<p>To evaluate estimator performance, we compared state-estimated values directly against quantities derived from encoder measurements under several controlled test cases. The following plots show results for straight-line motion, in-place pivoting, and arc motion, all conducted at a fixed effort of 50%.</p>
<div class="image">
<object type="image/svg+xml" data="estimator_vs_encoder_straight.svg" width="75%" style="pointer-events: none;"></object>
<div class="caption">
State-estimated and encoder-derived values during straight-line motion at 50% effort.</div></div>
<div class="image">
<object type="image/svg+xml" data="estimator_vs_encoder_pivot.svg" width="75%" style="pointer-events: none;"></object>
<div class="caption">
State-estimated and encoder-derived values during in-place pivot motion at 50% effort.</div></div>
<div class="image">
<object type="image/svg+xml" data="estimator_vs_encoder_arc.svg" width="75%" style="pointer-events: none;"></object>
<div class="caption">
State-estimated and encoder-derived values during arc motion at 50% effort.</div></div>
<p>Across these tests, the estimated arc length and heading tracked the encoder-derived values reasonably well. However, the estimated wheel velocity consistently differed in magnitude from the measured velocity, often appearing significantly lower. This discrepancy persisted across multiple trials and parameter adjustments.</p>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md60"></a>
Limitations and Design Decision</h2>
<p>Although portions of the estimator behaved as expected, the inconsistency in the velocity estimates raised concerns about the reliability of the overall state vector. Because wheel velocity is a foundational quantity used throughout the control architecture, uncertainty in this estimate limited our confidence in using the estimator for real-time decision-making during the term project.</p>
<p>As a result, we made the deliberate decision to rely on odometry-based calculations for estimating absolute position and heading. This approach was simpler, more transparent, and more consistent with the behavior observed on the physical robot. Importantly, this decision was informed directly by experimental results rather than theoretical considerations alone.</p>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md62"></a>
Odometry-Based Pose Estimation</h2>
<p>For the term project, absolute position and heading were computed using odometry derived from wheel encoder measurements. Incremental wheel motion was integrated over time to estimate:</p>
<ul>
<li>Total arc length traveled</li>
<li>Absolute X and Y position</li>
<li>Absolute heading angle</li>
</ul>
<p>These calculations were implemented in a dedicated task referred to as the <em>spectator task</em>. Conceptually, this task serves a similar role to a state estimator in that it provides higher-level information about the robot’s motion, but without relying on a full observer model.</p>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md64"></a>
Odometry Validation on Circular Line Following</h2>
<p>To evaluate the effectiveness of the odometry calculations, the robot was commanded to follow a circular line for approximately two full revolutions. During this test, both a real-world video of the robot and logged odometry data were recorded.</p>
<p>The video below shows the physical robot following the circular path:</p>
<p> 
<div class="image" style="text-align: center;">
  <video controls width="70%">
    <source src="Romi_Line_Following.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div class="caption">
    Romi following a circular line for approximately two full revolutions during odometry data collection.
  </div>
</div>
</p>
<p>Using the recorded odometry data (absolute X, Y, and heading), we generated an animation of the robot’s reconstructed motion. The animation closely matches the robot’s observed position and orientation throughout the test, providing strong qualitative validation of the odometry calculations.</p>
<p> 
<div class="image" style="text-align: center;">
  <video controls width="70%">
    <source src="romi_odometry_two_circles.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div class="caption">
    Odometry-based reconstruction of Romi’s position and orientation during the same circular line-following test.
  </div>
</div>
</p>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md66"></a>
Discussion</h2>
<p>The combination of state estimation and odometry work highlights an important aspect of system design: choosing the right level of model complexity for a given application. While the state estimator provided valuable insight and reinforced theoretical concepts from the course, odometry proved to be a more reliable and interpretable solution for our final system.</p>
<p>This experience emphasized the importance of validating algorithms against real hardware behavior and making design decisions based on experimental evidence rather than assumptions alone. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
